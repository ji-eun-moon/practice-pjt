# 230428 관통 프로젝트 08 - 알고리즘을 적용한 서버 구성
## 프로젝트 목표
- 데이터를 생성, 조회, 수정, 삭제할 수 있는 Web Application 제작
- AJAX 통신과 JSON 구조에 대한 이해
- Database many to one relationship(N:1)에 대한 이해
- Database many to many relationship(M:N)에 대한 이해
- 영화 추천 알고리즘 설계
---
# 유저 팔로우 기능
- AJAX 통신을 이용하여 유저 팔로우 기능을 구현하였다. 
## 팔로우/언팔로우 비동기 적용
- 팔로우 요청을 하는 form 요소의 id를 지정하고 querySelector를 통해 선택 후 이벤트 핸들러를 작성하였다.
    - axios 요청을 위해 필요한 user pk는 dataset 속성을 사용하였다.
    - hidden 타입으로 숨겨져 있는 csrf 값을 가진 input 태그를 통해 csrftoken을 보내도록 하였다. 
- 팔로우 버튼을 토글하기 위해 axios 요청을 통해 받는 response 객체를 활용해 view 함수를 통해 팔로우 여부를 파악할 수 있는 변수(is_followed)를 담아 JSON 타입으로 팔로우 여부를 확인하도록 하였다.
## 팔로워/팔로잉 수 비동기 적용
- 팔로워, 팔로잉 수를 선택할 수 있도록 span 태그에 id 속성을 적용한 뒤 querySelector를 통해 선택 후 이벤트 핸들러를 작성하였다.
- 팔로워, 팔로잉 인원 수 연산은 view 함수에서 진행하여 결과를 JSON 타입으로 전달하도록 하였다. 
- view 함수에서 응답한 연산 결과를 사용해 각 태그의 인원 수 값을 변경하도록 하였다. 
## 추가 구현
- 부트스트랩을 적용하여 팔로우/언팔로우 토글 시 버튼 색상도 함께 토글되도록 설정하였다.
---
# 리뷰 좋아요 기능
- AJAX 통신을 이용하여 리뷰 좋아요 기능을 구현하였다.
## 좋아요/좋아요 취소 비동기 적용
- 좋아요 요청을 하는 form 요소의 id를 지정하고 querySelector를 통해 선택 후 이벤트 핸들러를 작성하였다.
    - axios 요청을 위해 필요한 review pk는 dataset 속성을 사용하였다.
- review 각각 마다 좋아요/좋아요 취소가 가능해야 하므로 좋아요/좋아요 취소 버튼의 id에는 reveiw pk를 포함하도록 하였다. 
- 좋아요 버튼을 토글하기 위해 axios 요청을 통해 받는 response 객체를 활용해 view 함수를 통해 좋아요 여부를 파악할 수 있는 변수(is_liked)를 담아 JSON 타입으로 좋아요 여부를 확인하도록 하였다.
## 좋아요 수 비동기 적용
- 좋아요 수를 선택할 수 있도록 span 태그에 id 속성을 적용한 뒤 querySelector를 통해 선택 후 이벤트 핸들러를 작성하였다.
- 좋아요 수 연산은 view 함수에서 진행하여 결과를 JSON 타입으로 전달하도록 하였다. 
- view 함수에서 응답한 연산 결과를 사용해 각 태그의 좋아요 수 값을 변경하도록 하였다. 
    - 좋아요 수를 갖는 span 태그의 id는 좋아요 버튼과 마찬가지로 reveiw pk를 포함하도록 하였다.
## 추가 구현
- 부트스트랩을 적용하여 좋아요/좋아요 취소 토글 시 버튼 색상도 함께 토글되도록 설정하였다.
---
# Movies 앱 기능
## 전체 영화 목록 조회(index)
- 전체 영화 목록을 가져온 후 부트스트랩을 활용하여 카드 형태로 출력하도록 하였고, 화면 크기에 따라 카드 개수가 다르게 출력되도록 작성하였다.
- 카드 안에는 포스터 사진, 영화제목, 평점만을 포함하도록 작성하였다.
- 포스터 사진을 클릭하면 영화 상세 페이지로 이동하도록 구현하였고, 카드 하단에 상세보기 버튼도 따로 작성해주었다.
## 단일 영화 상세 조회(detail)
- 영화 상세 정보를 가져온 후 부트스트랩을 활용하여 단일 카드 안에 모든 영화 정보를 출력하도록 하였다.
- 포스터사진, 영화제목, 장르, 비슷한 영화를 추천해주는 페이지로 이동하는 링크 버튼을 포함한 모든 정보를 카드 body에 작성하였다.
## 영화 추천 기능 (recommended)
- 선택한 영화 페이지와 비슷한 장르의 영화를 추천해주는 페이지를 작성하고, 영화 상세 페이지에 링크를 작성하였다.
- Movie model에 비슷한 장르의 영화 객체들을 찾는 get_similar_movies 함수를 작성하였다.
    - 현재 영화 객체의 장르를 가져온 후
    - 가져온 장르를 가지고 다른 영화 객체를 찾고
    - 찾은 영화 객체들을 평점 기준으로 내림차순으로 정렬하여 return 하도록 하였다.
- 추천 페이지에서는 카드 형태로 출력하도록 하였고, 화면 크기에 따라 카드 개수가 다르게 출력하도록 작성하였다.
---
# Discussions
- 부트스트랩을 활용하여 base 템플릿을 반응형 nav바로 수정하였다.
    - 처음에 햄버거 버튼이 잘 작동되지 않았었는데, data-bs-toggle 속성명을 제대로 쓰지 않아서였다.
- axios 요청이 되지 않는 원인을 발견하는데 오래걸렸는데 base 템플릿에 script block 태그를 작성하지 않아서였다.
- form 태그 subimt 이벤트 핸들러 작성시 preventDefault 메서드를 통해 새로고침을 반드시 막아주어야 한다. 